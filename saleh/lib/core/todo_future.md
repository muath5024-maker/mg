# TODO للمستقبل - Saleh App

هذا الملف يحتوي على قائمة المهام المستقبلية للتطبيق.

---

## 1. ربط شاشات العميل بجداول Supabase

### شاشة Explore
- [ ] ربط مع جدول `stories` لجلب القصص/الفيديوهات
- [ ] ربط مع جدول `products` لجلب المنتجات المعروضة
- [ ] ربط مع جدول `stores` لجلب معلومات المتاجر
- [ ] ربط مع `product_media` من Cloudflare لعرض الصور والفيديوهات

### شاشة Stores
- [ ] جلب المتاجر حسب الفئة (عروض، شحن مجاني، إلخ) من جدول `stores`
- [ ] جلب المتاجر المميزة (`featured = true`)
- [ ] جلب المتاجر حسب التقييم (`rating`)
- [ ] عرض صور المتاجر من Cloudflare

### شاشة Home
- [ ] ربط مع جدول `products` لجلب المنتجات المميزة/الشائعة
- [ ] ربط مع جدول `stores` لجلب المتاجر المميزة
- [ ] ربط مع `product_media` من Cloudflare لعرض الصور
- [ ] تتبع الأحداث في Firebase Analytics (`view_product`, `view_store`)

### شاشة Cart
- [ ] ربط مع جدول `carts` لجلب سلة المستخدم الحالي
- [ ] ربط مع جدول `cart_items` لجلب عناصر السلة
- [ ] ربط مع جدول `products` لجلب تفاصيل المنتجات
- [ ] ربط مع `product_media` من Cloudflare لعرض صور المنتجات

### شاشة Map
- [ ] ربط مع جدول `stores` لجلب المتاجر مع إحداثيات الموقع
- [ ] عرض المتاجر على خريطة حقيقية (Google Maps / Mapbox)
- [ ] البحث عن المتاجر حسب الموقع الحالي
- [ ] عرض تفاصيل المتجر عند الضغط على Marker

---

## 2. إضافة Firebase Analytics + FCM

### Firebase Analytics
- [ ] تتبع الشاشات (`screen_view`)
- [ ] تتبع الأحداث:
  - `view_product`: عرض منتج
  - `add_to_cart`: إضافة منتج للسلة
  - `remove_from_cart`: حذف منتج من السلة
  - `view_store`: عرض متجر
  - `place_order`: إتمام طلب
  - `search`: البحث
  - `filter`: استخدام الفلاتر

### Firebase Cloud Messaging (FCM)
- [ ] إعداد FCM في التطبيق
- [ ] حفظ device token في Supabase
- [ ] استقبال إشعارات الطلبات:
  - إشعار للمستخدم عند تحديث حالة الطلب
  - إشعار للتاجر عند استلام طلب جديد
- [ ] إشعارات العروض والكوبونات
- [ ] إشعارات التحديثات العامة

---

## 3. إضافة Cloudflare

### تخزين الملفات
- [ ] إعداد Cloudflare R2 أو Workers للصور والفيديوهات
- [ ] رفع الصور من التطبيق إلى Cloudflare
- [ ] ربط `product_media` و `stories` مع روابط Cloudflare

### عرض الملفات
- [ ] عرض صور المنتجات من Cloudflare
- [ ] عرض فيديوهات القصص (Stories) من Cloudflare
- [ ] عرض صور المتاجر من Cloudflare
- [ ] تحسين الأداء (Caching, CDN)

---

## 4. ربط بوابات الدفع

### Tap Payment Gateway
- [ ] إعداد Tap SDK في التطبيق
- [ ] إنشاء جلسة دفع
- [ ] معالجة استجابة الدفع
- [ ] ربط مع جدول `payments` لتسجيل المعاملات

### HyperPay Gateway
- [ ] إعداد HyperPay SDK في التطبيق
- [ ] إنشاء جلسة دفع
- [ ] معالجة استجابة الدفع
- [ ] ربط مع جدول `payments` لتسجيل المعاملات

### معالجة حالات الدفع
- [ ] معالجة حالة الدفع الناجح
- [ ] معالجة حالة الدفع الفاشل
- [ ] معالجة حالة الدفع المعلق
- [ ] تحديث حالة الطلب في جدول `orders`

---

## 5. المحفظة والنقاط والكوبونات

### المحفظة (Wallet)
- [ ] جدول `wallets` في Supabase
- [ ] شاشة عرض الرصيد
- [ ] شاشة سجل المعاملات
- [ ] شحن المحفظة
- [ ] استخدام المحفظة في الدفع

### النقاط (Points)
- [ ] جدول `user_points` في Supabase
- [ ] نظام كسب النقاط (عند الشراء، التسجيل، إلخ)
- [ ] نظام استبدال النقاط
- [ ] شاشة عرض النقاط

### الكوبونات (Coupons)
- [ ] جدول `coupons` في Supabase
- [ ] جدول `user_coupons` في Supabase
- [ ] شاشة عرض الكوبونات المتاحة
- [ ] شاشة الكوبونات الخاصة بالمستخدم
- [ ] تطبيق الكوبون على الطلب
- [ ] التحقق من صحة الكوبون

---

## ملاحظات

- جميع المهام المذكورة أعلاه تحتاج إلى تصميم قاعدة البيانات في Supabase أولاً
- لا نستخدم RLS أو سياسات أمان الآن (CRUD مباشر)
- التركيز على Flutter + Supabase + Firebase + Cloudflare فقط

